//  tablesort.js
//  tristen @fallsemo
(function(){function a(a,b){a.tagName==="TABLE"?this.init(a,b||{}):console.error("Element must be a table")}a.prototype={init:function(a,b){var c=this,d;this.thead=!1,this.options=b,this.options.d=b.descending||!1,a.rows&&a.rows.length>0&&(a.tHead&&a.tHead.rows.length>0?(d=a.tHead.rows[a.tHead.rows.length-1],c.thead=!0):d=a.rows[0]);if(!d)return;for(var e=0;e<d.cells.length;e++){var f=d.cells[e];l(f,"no-sort")||(f.className+=" sort-header",m(f,"click",function(a){var b=g(f,"tr").getElementsByTagName("th");for(var d=0;d<b.length;d++)(l(b[d],"sort-up")||l(b[d],"sort-down"))&&b[d]!==this&&(b[d].className=b[d].className.replace(" sort-down","").replace(" sort-up",""));c.sortTable(this)}))}},sortTable:function(a){var b=this,c=a.cellIndex,d=g(a,"table"),m=function(a,c){var d=h(a.cells[b.col]).toLowerCase(),e=h(c.cells[b.col]).toLowerCase();return d===e?0:d<e?1:-1},n=function(a,c){var d=h(a.cells[b.col]);d=k(d);var e=h(c.cells[b.col]);return e=k(e),i(e,d)},o=function(a,c){var d=h(a.cells[b.col]).toLowerCase(),e=h(c.cells[b.col]).toLowerCase();return f(e)-f(d)};if(d.rows.length<=1)return;var p="",q=0;while(p===""&&q<d.tBodies[0].rows.length){p=h(d.tBodies[0].rows[q].cells[c]),p=j(p);if(p.substr(0,4)==="<!--"||p.length===0)p="";q++}if(p==="")return;var r;p.match(/^-?[£$Û¢´]\d/)||p.match(/^-?(\d+[,\.]?)+(E[-+][\d]+)?%?$/)?r=n:e(p)?r=o:(console.log("string"),r=m),this.col=c;var s=[],t=[],u,v;for(u=0;u<d.tBodies.length;u++)for(q=0;q<d.tBodies[u].rows[0].length;q++)s[q]=d.tBodies[u].rows[0][q];for(u=0;u<d.tBodies.length;u++)if(!b.thead)for(v=1;v<d.tBodies[u].rows.length;v++)t[v-1]=d.tBodies[u].rows[v];else for(v=0;v<d.tBodies[u].rows.length;v++)t[v]=d.tBodies[u].rows[v];t.sort(r),b.options.d?l(a,"sort-up")?(a.className=a.className.replace(/ sort-up/,""),a.className+=" sort-down",t.reverse()):(a.className=a.className.replace(/ sort-down/,""),a.className+=" sort-up"):l(a,"sort-down")?(a.className=a.className.replace(/ sort-down/,""),a.className+=" sort-up"):(a.className=a.className.replace(/ sort-up/,""),a.className+=" sort-down",t.reverse());for(q=0;q<t.length;q++)t[q].className||d.tBodies[0].appendChild(t[q])}};var b=/(Mon|Tue|Wed|Thu|Fri|Sat|Sun)\.?\,?\s*/i,c=/\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}/,d=/(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)/i,e=function(a){return(a.search(b)!==-1||a.search(c)!==-1||a.search(d!==-1))!==-1},f=function(a){return a=a.replace(/\-/g,"/"),a=a.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2})/,"$1/$2/$3"),(new Date(a)).getTime()},g=function(a,b){return a===null?null:a.nodeType===1&&a.tagName.toLowerCase()===b.toLowerCase()?a:g(a.parentNode,b)},h=function(a){var b=this;if(typeof a=="string"||typeof a=="undefined")return a;if(a.innerText)return a.innerText;var c="",d=a.childNodes,e=d.length;for(var f=0;f<e;f++)switch(d[f].nodeType){case 1:c+=b.getInnerText(d[f]);break;case 3:c+=d[f].nodeValue}return c},i=function(a,b){var c=parseFloat(a);a=isNaN(c)?0:c;var d=parseFloat(b);return b=isNaN(d)?0:d,a-b},j=function(a){return a.replace(/^\s+|\s+$/g,"")},k=function(a){return a.replace(/[^\-?0-9.]/g,"")},l=function(a,b){return(" "+a.className+" ").indexOf(" "+b+" ")>-1},m=function(a,b,c){a.attachEvent?(a["e"+b+c]=c,a[b+c]=function(){a["e"+b+c](window.event)},a.attachEvent("on"+b,a[b+c])):a.addEventListener(b,c,!1)};window.Tablesort=a})();